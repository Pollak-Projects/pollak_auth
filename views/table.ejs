<!DOCTYPE html>
<html lang="hu" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <title>Users</title>
</head>
<body>

    <div class="container-fluid h-100 d-flex justify-content-center align-items-center flex-column">
        <h3>Users</h3>
    <table class="table table-striped mt-3 w-50"> 
        
        
        <tr>
            <th>id</th>
            <th>username</th>
            <th>email</th>
            <th>Delete</th>
            <th>Changes</th>
            <th>Group</th>
        </tr>

        <% users.forEach(element => { %>
            <tr>

       
        <td>
            <input id="id" value="<%= element.id %>" disabled>
        </td>
        <td>
            <input id="username" value="<%= element.username %>">
        </td>
        <td>
            <input id="email" value="<%= element.email %>">
        </td>
        <td><button class="btn btn-danger" onclick="Delete()">Törlés</button></td>
        <td><button class="btn btn-warning" onclick="UpdateUser()">Módosítás</button></td>
        <td>
            <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
              <option selected>Groups</option>
              <option value="1">User</option>
            </select>
        </td>
       
    </tr>
    <% }); %>
    </table>
 
</div>

</body>
<script>
    const id = document.getElementById("id")
    console.log(id.value)
    const username = document.getElementById("username")
    const email = document.getElementById("email")

    function Delete(){
        fetch(`http://localhost:3300/user/delete`, {
            headers: {
                'Content-Type': 'application/json'
            },
            method: "DELETE",
            body: JSON.stringify({
               id : id.value
            })
        }).then((res) => {
            location.reload();
        })
    }

    function UpdateUser(){
        fetch(`http://localhost:3300/user/update`, {
            headers: {
                'Content-Type': 'application/json'
            },
            method: "PUT",
            body: JSON.stringify({
               id : id.value,
               username: username.value,
               email: email.value
            })
        }).then((res) => {
            console.log("updated")
            location.reload();
        })
    }


</script>
</html>