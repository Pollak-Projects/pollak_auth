<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Token Settings</title>
    <style>
        body {
            background-color: #f5f5f5;
            font-family: Arial, sans-serif;
        }
        .form-container {
            max-width: 500px;
            margin: 50px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .form-label {
            font-weight: bold;
            color: #333333;
        }
        .form-check-label {
            margin-left: 5px;
        }
        .form-check-input:checked {
            background-color: #007bff;
            border-color: #007bff;
        }
        .btn-custom {
            width: 100%;
            background-color: #007bff;
            color: #ffffff;
            border: none;
        }
        .btn-custom:hover {
            background-color: #0056b3;
        }
    </style>
    <script type="text/javascript">
        function togglePasswordVisibility(id) {
            var inputField = document.getElementById(id);
            inputField.type = inputField.type === "password" ? "text" : "password";
        }

        // Fetch API a token beállítások frissítéséhez
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("settingsForm").addEventListener("submit", function(event) {
                event.preventDefault();

                const data = {
                    JWTSecret: document.getElementById("jwtSecret").value,
                    JWTExpiration: document.getElementById("jwtExpire").value,
                    JWTAlgorithm: document.getElementById("jwtAlgorithm").value,
                    RefreshTokenSecret: document.getElementById("refreshSecret").value,
                    RefreshTokenExpiration: document.getElementById("refreshExpire").value,
                    RefreshTokenAlgorithm: document.getElementById("refreshAlgorithm").value,
                };

                fetch("/auth/update", {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(data),
                })
                .then(response => response.json())
                .then(result => {
                    console.log(result)
                    alert(result.message); // Sikeres mentés visszajelzése
                })
                .catch(error => {
                    console.error("Error:", error);
                });
            });
        });
    </script>
</head>
<body>
    <div class="form-container">
        <form id="settingsForm">
            <div class="mb-3">
                <label for="jwtSecret" class="form-label">JWT Secret</label>
                <input type="password" id="jwtSecret" name="jwtSecret" class="form-control" value="<%= tokenData.JWTSecret %>">
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" onclick="togglePasswordVisibility('jwtSecret')">
                    <label class="form-check-label">Show JWT Secret</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="jwtExpire" class="form-label">JWT Expiration</label>
                <input type="number" id="jwtExpire" name="jwtExpire" class="form-control" value="<%= tokenData.JWTExpiration %>">
            </div>
            <div class="mb-3">
                <label for="jwtAlgorithm" class="form-label">JWT Algorithm</label>
                <input type="text" id="jwtAlgorithm" name="jwtAlgorithm" class="form-control" value="<%= tokenData.JWTAlgorithm %>">
            </div>

            <hr>

            <div class="mb-3">
                <label for="refreshSecret" class="form-label">Refresh Token Secret</label>
                <input type="password" id="refreshSecret" name="refreshSecret" class="form-control" value="<%= tokenData.RefreshTokenSecret %>">
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" onclick="togglePasswordVisibility('refreshSecret')">
                    <label class="form-check-label">Show Refresh Token Secret</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="refreshExpire" class="form-label">Refresh Token Expiration</label>
                <input type="number" id="refreshExpire" name="refreshExpire" class="form-control" value="<%= tokenData.RefreshTokenExpiration %>">
            </div>
            <div class="mb-3">
                <label for="refreshAlgorithm" class="form-label">Refresh Token Algorithm</label>
                <input type="text" id="refreshAlgorithm" name="refreshAlgorithm" class="form-control" value="<%= tokenData.RefreshTokenAlgorithm %>">
            </div>

            <button type="submit" class="btn btn-custom mt-3">Save Settings</button>
        </form>
    </div>
</body>
</html>